#summary Data Access related components.
#labels iPhone,iPad,Cocoa,CoreData,Data,DAO

= Introduction =

This section contains [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data common data access components].

= Details =

Data access components include:
  * [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/ DAO pattern] components:
    * [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICQuerySpec.h OxICQuerySpec], a class for holding query definitions.
    * [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProtocol.h OxICDaoProtocol], which provides a common interface for basic DAO operations.
    * [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICBaseDao.m OxICBaseDao], which provides a basic [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProtocol.h OxICDaoProtocol] implementation using [http://en.wikipedia.org/wiki/Core_Data CoreData].
    * [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProxy.m OxICDaoProxy], which translates invocations into [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProtocol.h OxICDaoProtocol] find methods.


= OxICDaoProxy samples =
Suppose we have the following protocol:

{{{
@protocol PersonDao

- (NSArray*) findByName:(NSString*)namePart;
- (Person*) findJohnLennon;

- (id) insertNewObject;
- (void) delete:(id) anObject;
- (void) flush;

@end
}}}

The proxy allows mapping methods with queries, which will be executed using the findWithQuerySpec:andArguments: method int the [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProtocol.h OxICDaoProtocol]  class.

In the following examples, we'll show how to map the first two (findByName and findJohnLennon). Unmapped methods (insertNewObject, delete:, flush) are directly forwarded to [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProtocol.h OxICDaoProtocol] object.


== Standalone ==
You must initialize the object by passing the [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProtocol.h OxICDaoProtocol] instance to be wrapped (*realPersonDao* in this example) and the protocol to be used in order to access the proxy.

{{{
OxICDaoProxy *proxy = [[OxICDaoProxy alloc] initWithDao:realPersonDao
                                            andProtocol:@protocol(PersonDao)];

}}}

Once the proxy is created, you can add query specifications to be binded with selectors:

{{{
[proxy = addSelector:@"findJohnLennon"
       withQuerySpec:[OxICQuerySpec withFilter:@"name = 'John Lennon'"
                                     andUnique:YES]];

[proxy = addSelector:@"findByName:"
       withQuerySpec:[OxICQuerySpec withFilter:@"name contains %@"]];
}}}

== With container ==
The [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProxyFactoryObject.h OxICDaoProxyFactoryObject]  class provides a factory for creating [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProxy.m OxICDaoProxy] instances from the [Container IoC container].

{{{
[container addDefinition: [OxICObjectDefinition withName: @"personDao"
                                                andClass: @"OxICDaoProxyFactoryObject"
                                             andSingleton: FALSE
                                                  andLazy: FALSE
                                            andReferences: [NSDictionary dictionaryWithObjectsAndKeys:
                                                             @"realPersonDao", @"dao",
                                                             nil
                                                           ]
                                                andValues: [NSDictionary dictionaryWithObjectsAndKeys:
                                                             @protocol(PersonDao), @"protocol",
                                                             [NSDictionary dictionaryWithObjectsAndKeys:
                                                               [OxICQuerySpec withFilter:@"name = 'John Lennon'"
                                                                               andUnique:YES], 
                                                                              @"findJohnLennon",
                                                               [OxICQuerySpec withFilter:@"name contains %@"], 
                                                                              @"findByName:",
                                                               nil], @"querySpecs",
                                                               nil
                                                             ]
                                                           ]
];
}}}

In this example, the container must have a definition for a [http://code.google.com/p/oxeniphonecommons/source/browse/trunk/main/Classes/Data/DAO/OxICDaoProtocol.h OxICDaoProtocol]  DAO called *realPersonDao*.